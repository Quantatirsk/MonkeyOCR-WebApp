{
  "project": {
    "name": "MonkeyOCR WebApp",
    "description": "支持图片和PDF内容提取的可视化展示WebApp",
    "version": "1.0.0",
    "architecture": "前后端分离",
    "features": [
      "文件上传（拖拽支持）",
      "OCR内容提取",
      "Markdown内容可视化",
      "图片资源展示",
      "批量处理",
      "实时进度跟踪",
      "结果导出下载"
    ]
  },
  "tech_stack": {
    "frontend": {
      "framework": "React 18",
      "build_tool": "Vite",
      "language": "TypeScript",
      "styling": "TailwindCSS",
      "ui_library": "shadcn/ui",
      "state_management": "Zustand",
      "icons": "Lucide React",
      "markdown": "react-markdown + remark",
      "http_client": "axios",
      "file_upload": "react-dropzone"
    },
    "backend": {
      "framework": "FastAPI",
      "language": "Python 3.8+",
      "http_client": "httpx",
      "file_handling": "zipfile + pathlib",
      "static_files": "FastAPI StaticFiles",
      "cors": "fastapi-cors"
    }
  },
  "project_structure": {
    "root": "/opt/MonkeyUI",
    "directories": {
      "frontend/": "React前端应用",
      "frontend/src/": "源代码目录",
      "frontend/src/components/": "React组件",
      "frontend/src/store/": "Zustand状态管理",
      "frontend/src/types/": "TypeScript类型定义",
      "frontend/src/utils/": "工具函数",
      "frontend/src/api/": "API调用封装",
      "frontend/public/": "静态资源",
      "backend/": "FastAPI后端",
      "backend/api/": "API路由",
      "backend/utils/": "工具函数",
      "backend/models/": "数据模型",
      "uploads/": "上传文件临时存储",
      "results/": "处理结果存储",
      "static/": "静态文件服务"
    }
  },
  "typescript_types": {
    "core_interfaces": {
      "ProcessingTask": {
        "id": "string",
        "filename": "string",
        "file_type": "'pdf' | 'image'",
        "status": "'pending' | 'processing' | 'completed' | 'failed'",
        "progress": "number",
        "created_at": "string",
        "completed_at": "string | null",
        "error_message": "string | null",
        "result_url": "string | null"
      },
      "DocumentResult": {
        "task_id": "string",
        "markdown_content": "string",
        "images": "ImageResource[]",
        "download_url": "string",
        "metadata": "DocumentMetadata"
      },
      "ImageResource": {
        "filename": "string",
        "path": "string",
        "url": "string",
        "alt": "string | null"
      },
      "DocumentMetadata": {
        "total_pages": "number",
        "processing_time": "number",
        "file_size": "number",
        "extraction_type": "'standard' | 'split' | 'text' | 'formula' | 'table'"
      },
      "APIResponse<T>": {
        "success": "boolean",
        "data": "T | null",
        "message": "string",
        "error": "string | null"
      }
    },
    "zustand_store_types": {
      "AppState": {
        "tasks": "ProcessingTask[]",
        "currentTask": "ProcessingTask | null",
        "results": "DocumentResult[]",
        "isUploading": "boolean",
        "searchQuery": "string"
      },
      "AppActions": {
        "addTask": "(task: Omit<ProcessingTask, 'id'>) => void",
        "updateTask": "(id: string, updates: Partial<ProcessingTask>) => void",
        "setCurrentTask": "(task: ProcessingTask | null) => void",
        "addResult": "(result: DocumentResult) => void",
        "setSearchQuery": "(query: string) => void",
        "clearResults": "() => void"
      }
    }
  },
  "react_components": {
    "layout_components": {
      "App": {
        "purpose": "根组件，包含路由和全局状态",
        "props": "无",
        "children": ["Header", "MainContent", "Footer"]
      },
      "Header": {
        "purpose": "顶部导航和标题",
        "props": "无",
        "features": ["应用标题", "主题切换", "状态指示器"]
      },
      "MainContent": {
        "purpose": "主内容区域",
        "props": "无",
        "children": ["UploadZone", "TaskList", "DocumentViewer"]
      }
    },
    "feature_components": {
      "UploadZone": {
        "purpose": "文件上传区域",
        "props": {
          "onFileUpload": "(files: File[]) => void",
          "isUploading": "boolean",
          "acceptedTypes": "string[]"
        },
        "features": ["拖拽上传", "文件类型验证", "进度显示", "多文件支持"],
        "dependencies": ["react-dropzone", "lucide-react"]
      },
      "TaskList": {
        "purpose": "任务列表和状态管理",
        "props": {
          "tasks": "ProcessingTask[]",
          "onTaskSelect": "(task: ProcessingTask) => void",
          "currentTaskId": "string | null"
        },
        "features": ["任务状态显示", "进度条", "错误提示", "重试功能"]
      },
      "DocumentViewer": {
        "purpose": "文档内容展示",
        "props": {
          "document": "DocumentResult | null",
          "searchQuery": "string"
        },
        "features": ["Markdown渲染", "图片展示", "搜索高亮", "导出功能"],
        "dependencies": ["react-markdown", "remark-gfm"]
      },
      "ProcessingStatus": {
        "purpose": "处理状态指示器",
        "props": {
          "task": "ProcessingTask",
          "showDetails": "boolean"
        },
        "features": ["实时进度", "状态图标", "时间估算", "错误详情"]
      },
      "SearchBar": {  
        "purpose": "内容搜索",
        "props": {
          "value": "string",
          "onChange": "(value: string) => void",
          "placeholder": "string"
        },
        "features": ["实时搜索", "搜索建议", "清空功能"]
      },
      "ImageGallery": {
        "purpose": "图片资源展示",
        "props": {
          "images": "ImageResource[]",
          "onImageClick": "(image: ImageResource) => void"
        },
        "features": ["缩略图展示", "点击放大", "懒加载"]
      }
    },
    "ui_components": {
      "shadcn_components": [
        "Button", "Card", "Progress", "Badge", "Alert", 
        "Dialog", "Input", "Tabs", "ScrollArea", "Separator"
      ],
      "custom_components": {
        "FileIcon": "文件类型图标组件",
        "StatusBadge": "状态徽章组件", 
        "LoadingSpinner": "加载动画组件",
        "EmptyState": "空状态组件"
      }
    }
  },
  "backend_api": {
    "base_config": {
      "host": "0.0.0.0",
      "port": 8001,
      "cors_origins": ["http://localhost:5173"],
      "monkeyocr_api": "https://ocr.teea.cn"
    },
    "endpoints": {
      "upload": {
        "method": "POST",
        "path": "/api/upload",
        "description": "上传文件并开始处理",
        "request": {
          "files": "List[UploadFile]",
          "extract_type": "str = 'standard'",
          "split_pages": "bool = False"
        },
        "response": "APIResponse[ProcessingTask]",
        "workflow": [
          "验证文件类型和大小",
          "生成任务ID",
          "调用MonkeyOCR API",
          "返回任务信息"
        ]
      },
      "task_status": {
        "method": "GET", 
        "path": "/api/tasks/{task_id}/status",
        "description": "获取任务处理状态",
        "response": "APIResponse[ProcessingTask]"
      },
      "task_result": {
        "method": "GET",
        "path": "/api/tasks/{task_id}/result", 
        "description": "获取处理结果",
        "response": "APIResponse[DocumentResult]",
        "workflow": [
          "下载MonkeyOCR结果zip",
          "解压并处理文件",
          "修正图片路径",
          "返回结构化结果"
        ]
      },
      "download": {
        "method": "GET",
        "path": "/api/download/{task_id}",
        "description": "下载原始结果文件",
        "response": "FileResponse"
      },
      "tasks_list": {
        "method": "GET",
        "path": "/api/tasks",
        "description": "获取所有任务列表",
        "response": "APIResponse[List[ProcessingTask]]"
      },
      "static_files": {
        "method": "GET",
        "path": "/static/{file_path:path}",
        "description": "静态文件服务",
        "response": "FileResponse"
      }
    },
    "utilities": {
      "zip_processor": {
        "purpose": "处理MonkeyOCR返回的zip文件",
        "functions": [
          "extract_zip(zip_path: str, extract_to: str) -> Dict",
          "process_markdown(md_path: str, images_dir: str) -> str",
          "fix_image_paths(content: str, base_url: str) -> str"
        ]
      },
      "monkeyocr_client": {
        "purpose": "MonkeyOCR API客户端",
        "functions": [
          "parse_document(file_path: str, split_pages: bool) -> Dict",
          "get_task_status(task_id: str) -> Dict",
          "download_result(download_url: str) -> bytes"
        ]
      }
    }
  },
  "zustand_store": {
    "app_store": {
      "state": {
        "tasks": "ProcessingTask[]",
        "currentTaskId": "string | null",
        "results": "Map<string, DocumentResult>",
        "isUploading": "boolean",
        "searchQuery": "string",
        "theme": "'light' | 'dark'"
      },
      "actions": {
        "uploadFiles": "async (files: File[], options: UploadOptions) => Promise<void>",
        "pollTaskStatus": "(taskId: string) => void",
        "selectTask": "(taskId: string) => void",
        "loadResult": "async (taskId: string) => Promise<void>",
        "searchContent": "(query: string) => void",
        "clearTask": "(taskId: string) => void",
        "toggleTheme": "() => void"
      },
      "computed": {
        "currentTask": "computed from currentTaskId and tasks",
        "currentResult": "computed from currentTaskId and results",
        "completedTasks": "computed from tasks with status 'completed'",
        "isProcessing": "computed from tasks with status 'processing'"
      }
    }
  },
  "styling_system": {
    "tailwind_config": {
      "theme": {
        "extend": {
          "colors": "shadcn/ui color palette",
          "animation": "custom loading animations",
          "spacing": "consistent spacing scale"
        }
      },
      "plugins": ["@tailwindcss/typography", "tailwindcss-animate"]
    },
    "component_patterns": {
      "layout": "flex/grid based responsive layouts",
      "cards": "shadcn Card with consistent padding and borders",
      "buttons": "shadcn Button variants with proper states",
      "inputs": "shadcn Input with validation styles",
      "feedback": "Alert, Badge, Progress components for user feedback"
    }
  },
  "development_workflow": {
    "setup_steps": [
      "创建项目目录结构",
      "初始化前端Vite+React项目",
      "安装和配置shadcn/ui",
      "设置TailwindCSS", 
      "创建FastAPI后端",
      "配置CORS和静态文件服务",
      "实现基础API端点",
      "创建核心React组件",
      "集成Zustand状态管理",
      "实现文件上传功能",
      "集成MonkeyOCR API",
      "实现结果展示功能",
      "添加搜索和导出功能",
      "样式优化和响应式设计",
      "错误处理和用户体验优化",
      "测试和部署"
    ],
    "priority_order": {
      "phase_1": ["项目初始化", "基础组件", "文件上传", "API集成"],
      "phase_2": ["结果展示", "状态管理", "样式优化"],
      "phase_3": ["高级功能", "用户体验", "性能优化"]
    }
  },
  "package_dependencies": {
    "frontend": {
      "dependencies": {
        "react": "^18.2.0",
        "react-dom": "^18.2.0",
        "typescript": "^5.0.2",
        "vite": "^4.4.0",
        "@vitejs/plugin-react": "^4.0.3",
        "tailwindcss": "^3.3.0",
        "autoprefixer": "^10.4.14",
        "postcss": "^8.4.24",
        "zustand": "^4.4.0",
        "axios": "^1.5.0",
        "react-dropzone": "^14.2.3",
        "react-markdown": "^8.0.7",
        "remark-gfm": "^3.0.1",
        "lucide-react": "^0.263.1",
        "class-variance-authority": "^0.7.0",
        "clsx": "^2.0.0",
        "tailwind-merge": "^1.14.0"
      },
      "devDependencies": {
        "@types/react": "^18.2.15",
        "@types/react-dom": "^18.2.7",
        "@typescript-eslint/eslint-plugin": "^6.0.0",
        "@typescript-eslint/parser": "^6.0.0",
        "eslint": "^8.45.0",
        "eslint-plugin-react-hooks": "^4.6.0",
        "eslint-plugin-react-refresh": "^0.4.3"
      }
    },
    "backend": {
      "dependencies": [
        "fastapi[all]>=0.100.0",
        "uvicorn[standard]>=0.23.0",
        "httpx>=0.24.0",
        "python-multipart>=0.0.6",
        "python-jose[cryptography]>=3.3.0",
        "aiofiles>=23.0.0"
      ]
    }
  },
  "deployment": {
    "development": {
      "frontend": "npm run dev (Vite dev server on :5173)",
      "backend": "uvicorn main:app --reload --host 0.0.0.0 --port 8001"
    },
    "production": {
      "frontend": "npm run build -> nginx static serving",
      "backend": "uvicorn main:app --host 0.0.0.0 --port 8001",
      "reverse_proxy": "nginx for API and static files"
    }
  },
  "key_features": {
    "file_upload": {
      "supported_formats": [".pdf", ".jpg", ".jpeg", ".png"],
      "max_file_size": "50MB per file",
      "batch_upload": "支持多文件同时上传",
      "drag_drop": "拖拽上传支持"
    },
    "processing_modes": {
      "standard": "标准文档解析",
      "split": "按页分割解析", 
      "text": "纯文本提取",
      "formula": "数学公式识别",
      "table": "表格提取"
    },
    "result_display": {
      "markdown_rendering": "使用react-markdown渲染MD内容",
      "image_gallery": "图片资源预览和放大",
      "search_highlight": "搜索关键词高亮",
      "export_options": "导出MD文件和图片"
    },
    "user_experience": {
      "real_time_progress": "实时处理进度显示",
      "error_handling": "友好的错误提示和重试",
      "responsive_design": "桌面和移动端适配",
      "dark_mode": "明暗主题切换"
    }
  }
}